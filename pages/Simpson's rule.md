alias:: 辛普森法, Simpson 式

- 辛普森法（Simpson's Rule）是一种用于数值积分的方法，它通过用二次多项式来近似积分区间内的被积函数，从而得到积分的近似值。辛普森法在数值分析中被广泛使用，尤其适用于被积函数较为平滑的情况。它是基于拉格朗日插值多项式的思想发展而来。
- ### 辛普森法的基本原理
  辛普森法的基本思想是将积分区间 \([a, b]\) 分为 \(n\) 个等长的子区间，其中 \(n\) 需要是偶数。每一对相邻的子区间（宽度为 \(2h\)，其中 \(h = \frac{b - a}{n}\)）与 \(x\) 轴以及通过这两个子区间端点和中点上的函数值所定义的二次多项式围成的区域可以近似代表该区间上的定积分。
  对于每一对子区间 \([x_{2i}, x_{2i+2}]\)，辛普森法的公式为：
  $$ \int_{x_{2i}}^{x_{2i+2}} f(x) dx \approx \frac{h}{3} [f(x_{2i}) + 4f(x_{2i+1}) + f(x_{2i+2})] $$
  其中 \(x_{2i+1}\) 是 \(x_{2i}\) 和 \(x_{2i+2}\) 的中点。
- ### 辛普森法的数学推导
  辛普森法是[[牛顿-柯特斯公式]]的一个特例。
  辛普森法的推导基于二次[[拉格朗日插值多项式]]。对于每一对子区间 \([x_{2i}, x_{2i+2}]\)，可以构造一个二次多项式 \(P_2(x)\) ，使得 \(P_2(x)\) 在 \(x_{2i}\), \(x_{2i+1}\), 和 \(x_{2i+2}\) 处的值分别等于 \(f(x_{2i})\), \(f(x_{2i+1})\), 和 \(f(x_{2i+2})\)。然后，用该多项式在这两个子区间上的积分来近似原函数在这两个子区间上的积分。
- ### 辛普森法的误差估计
  辛普森法的误差估计可以通过考虑被积函数的四阶导数来获得。对于光滑函数，辛普森法通常具有较高的精度。误差估计公式大致为：
  $$ E \approx \frac{(b-a)^5}{180n^4} \max_{\xi \in [a,b]} |f^{(4)}(\xi)| $$
  其中 \(f^{(4)}(\xi)\) 是函数在区间 \([a, b]\) 上的四阶导数的最大绝对值。
- ### 使用场景和限制
  辛普森法特别适用于被积函数比较平滑的情况。当函数具有较大的曲率或者在积分区间内有不连续点时，辛普森法的精度可能会降低。在这些情况下，可能需要使用更细的子区间划分，或者考虑使用其他数值积分方法，如高斯积分或自适应积分方法。
- ### 辛普森法的变体
  
  除了基本的辛普森法，还有一些变体，如复合辛普森法（Composite Simpson's Rule）和辛普森3/8法则（Simpson's 3/8 Rule）。这些变体适用于不同的应用场景和需求。
	- 1. **复合辛普森法**：当积分区间较长或被积函数变化较大时，可以使用复合辛普森法。这种方法将整个积分区间分为更多的小区间，每个小区间应用辛普森法，然后将所有小区间的积分值求和。这样可以提高数值积分的精度。
	- 2. **辛普森3/8法则**：这是另一种基于三阶拉格朗日插值多项式的方法。它将每个积分区间分为三个等长的子区间，使用四个点（而不是三个）的函数值进行插值和积分近似。辛普森3/8法则在某些特定情况下可以提供比标准辛普森法更好的结果。
-
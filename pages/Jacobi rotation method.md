alias:: 雅可比旋转法

- TODO 雅可比求解器（Jacobi Solver）通常指用于解线性方程组的雅可比迭代方法。但在上下文中，如用于求解特征值和特征向量，我们通常指的是雅可比旋转法（Jacobi Rotation Method），这是一个特定于求解对称矩阵特征值问题的方法。此方法适用于对称矩阵，并通过旋转使矩阵逐步变为对角矩阵的形式，从而获取特征值（对角线上的元素）和特征向量（旋转矩阵的列）。下面详细描述这个过程。
- ### Jacobi Rotation Method 的工作原理
- 雅可比旋转法是一种有效的数值算法，用于计算对称矩阵的所有特征值和对应的特征向量。该方法通过一系列的旋转操作，将矩阵逐渐转换为对角矩阵。
- #### 步骤细节
	- **初始化**：
	  logseq.order-list-type:: number
		- 设定初始矩阵 \( A_0 = A \)。
	- **选择旋转**：
	  logseq.order-list-type:: number
		- 在每次迭代中，找到非对角线上绝对值最大的元素 \( a_{pq} \)。
	- **计算旋转参数**：
	  logseq.order-list-type:: number
		- 通过以下公式计算角度 \( \theta \)，其中 \( \tau \) 是 \( (a_{qq} - a_{pp})/(2a_{pq}) \)：
		  $$t = \frac{\text{sgn}(\tau)}{|\tau| + \sqrt{1 + \tau^2}}$$
		  $$\cos(\theta) = \frac{1}{\sqrt{1 + t^2}}, \quad \sin(\theta) = t \cdot \cos(\theta)$$
	- **构造旋转矩阵 \( J \)**：
	  logseq.order-list-type:: number
		- \( J \) 是单位矩阵，除了四个位置：\( J_{pp}, J_{qq}, J_{pq}, J_{qp} \)，其中：
		  $$J_{pp} = J_{qq} = \cos(\theta), \quad J_{pq} = -\sin(\theta), \quad J_{qp} = \sin(\theta)$$
	- **应用旋转**：
	  logseq.order-list-type:: number
		- 更新 \( A \) 为 \( A' = J^T A J \)，这个操作会“零化” \( a_{pq} \) 并更新其他元素。
	- **检查收敛**：
	  logseq.order-list-type:: number
		- 迭代直到所有非对角线元素的绝对值之和小于某个预定的阈值。
	- **提取结果**：
	  logseq.order-list-type:: number
		- 对角线元素 \( a_{ii} \) 是特征值。
		- 累计所有旋转矩阵 \( J \) 的乘积将给出对应的特征向量。
- #### 特性和优势
	- **效率**：对于小型到中型矩阵，雅可比旋转法非常有效，但对于大型矩阵，计算成本可能较高。
	- **正交性**：旋转矩阵保持特征向量的正交性，这是数值稳定性的一个重要因素。
	- **直观性**：这种方法的概念直观，易于理解和实现。
- 雅可比旋转法特别适用于需要精确求解小型或中型对称矩阵特征值问题的应用。对于大规模矩阵，可能需要考虑更加高效的现代算法，如[[隐式重启的Arnoldi方法]]或[[Lanczos方法]]。这些方法特别设计来处理大规模稀疏或密集矩阵的特征值问题，能够提供更高的性能和效率。
  <!--Converted by ToLogseq-->
- ## 例子
- 让我们以一个具体的三维对称矩阵为例，使用雅可比旋转法来计算其特征值和特征向量。我们选择一个简单的对称矩阵来进行演示：
- $$A = \begin{bmatrix}
  2 & 1 & 1 \\
  1 & 3 & 1 \\
  1 & 1 & 2
  \end{bmatrix}$$
- ### 步骤 1: 初始化
	- 起始矩阵 \( A_0 = A \)。
- ### 步骤 2: 选择旋转元素
	- 选取非对角线上绝对值最大的元素进行旋转。在矩阵 \( A \) 中，非对角元素 \( 1 \) 相同，我们可以选择 \( a_{12} \) 或 \( a_{13} \) 或 \( a_{23} \)，这里我们选择 \( a_{12} \)。
- ### 步骤 3: 计算旋转参数
	- 计算 \( \tau \) 和 \( t \)：
	  $$\tau = \frac{a_{22} - a_{11}}{2a_{12}} = \frac{3 - 2}{2 \times 1} = 0.5$$
	  $$t = \frac{\text{sgn}(0.5)}{|0.5| + \sqrt{1 + 0.5^2}} = \frac{1}{0.5 + \sqrt{1.25}} \approx 0.618$$
	  $$\cos(\theta) = \frac{1}{\sqrt{1 + 0.618^2}} \approx 0.850, \quad \sin(\theta) = 0.618 \times 0.850 \approx 0.526$$
- ### 步骤 4: 构造旋转矩阵
	- 构造旋转矩阵 \( J \) 用于消除 \( a_{12} \)：
	  $$J = \begin{bmatrix}
	  - 850 & -0.526 & 0 \\
	  - 526 & 0.850 & 0 \\
	  0 & 0 & 1
	  \end{bmatrix}$$
- 好的，我们可以更详细地探讨雅可比旋转法中的步骤5（应用旋转）及之后的步骤，并以我们的示例矩阵继续进行分析。
- ### 步骤5：应用旋转
  
  在步骤3中，我们计算了旋转角 \(\theta\) 的 \(\cos(\theta)\) 和 \(\sin(\theta)\)。为了更新矩阵 \(A\)，我们需要使用旋转矩阵 \(J\)，该矩阵专门设计用于零化选择的非对角线元素 \(a_{12}\)。旋转矩阵 \(J\) 为：
  
  \[
  J = \begin{bmatrix}
  0.850 & -0.526 & 0 \\
  0.526 & 0.850 & 0 \\
  0 & 0 & 1
  \end{bmatrix}
  \]
  
  **更新矩阵 \(A\)**:
	- 要应用旋转并更新矩阵 \(A\)，我们执行以下操作：
	  \[
	  A' = J^T A J
	  \]
	- 首先，我们计算 \(J^T A\)，然后用结果乘以 \(J\)。
- **计算 \(J^T A\)**:
	- \(J^T\) 是 \(J\) 的转置，计算得：
	  \[
	  J^T = \begin{bmatrix}
	  0.850 & 0.526 & 0 \\
	  -0.526 & 0.850 & 0 \\
	  0 & 0 & 1
	  \end{bmatrix}
	  \]
- 然后，将 \(J^T\) 与 \(A\) 相乘：
  $$
  J^T A = \begin{bmatrix}
  0.850 & 0.526 & 0 \\
  -0.526 & 0.850 & 0 \\
  0 & 0 & 1
  \end{bmatrix}
  \begin{bmatrix}
  2 & 1 & 1 \\
  1 & 3 & 1 \\
  1 & 1 & 2
  \end{bmatrix}
  $$
  
  **计算 \(J^T A J\)**:
	- 接着，将 \(J^T A\) 的结果与 \(J\) 相乘得到最终的更新矩阵 \(A'\)。
- ### 步骤6：检查收敛
	- 在每次迭代后，检查矩阵的非对角线元素。如果所有非对角线元素的绝对值之和小于某个预设的阈值（例如，\(10^{-5}\) 或更小），则算法终止，认为矩阵已经足够接近对角形。
	- 如果尚未收敛，重复步骤2到5，选择下一个最大的非对角线元素进行旋转。
- ### 步骤7：提取结果
	- **特征值**：一旦矩阵 \(A\) 收敛到对角矩阵，对角线上的元素就是矩阵 \(A\) 的特征值。
	- **特征向量**：累计所有的旋转矩阵 \(J\) 的乘积。每次旋转的 \(J\) 应该从右侧乘到之前的乘积上（如果跟踪特征向量的话）。最终得到的乘积矩阵的列向量将是对应的特征向量。
- 这种雅可比旋转法在处理对称矩阵特征值问题时是非常有效的，尤其适合于那些元素较少、对精度要求较高的情况。
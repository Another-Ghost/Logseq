alias:: 碎片

- 造成[[堆]]利用率很低的主要原因是一种称为[[碎片]]的现象，当虽然有未使用的内存但不能用来满足分配请求时，就发生这种现象。
- 有两种形式的碎片：
	- [[内部碎片]]是在一个[[已分配块]]比[[有效载荷]]大时发生的。
	  logseq.order-list-type:: number
	  很多原因都可能造成这个问题。
		- 例如，一个分配器的实现可能对已分配块强加一个最小的大小值，而这个大小要比某个请求的有效载荷大。
		  或者，分配器可能增加块大小以满足对齐约束条件。内部碎片的量化是简单明了的。它就是已分配块大小和它们的有效载荷大小之差的和。因此，在任意时刻，内部碎片的数最只取决于以前请求的模式和分配器的实现方式。外部碎片是当空闲内存合计起来足够满足一个分配请求，但是没有一个单独的空闲块足够大可以来处理这个请求时发生的。例如，如果图 9-34e 中的请求要求 6 个字，而不是2 个字，那么如果不向内核请求额外的虚拟内存就无法满足这个请求，即使在堆中仍然